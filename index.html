<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>è½©è½©ç”Ÿæ—¥å€’è®¡æ—¶ â€” ç§‘æŠ€é£</title>
<style>
  :root{
    --bg1:#0b1220;
    --accent:#33d1ff;
    --accent2:#7affc2;
    --glass: rgba(255,255,255,0.06);
    --card: rgba(255,255,255,0.04);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;}
  body{
    background: radial-gradient(1200px 600px at 10% 20%, rgba(15,30,60,0.35), transparent),
                linear-gradient(180deg,var(--bg1) 0%, #07101a 100%);
    color:#cfeeff;
    overflow:hidden;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:24px;
  }
  #fxCanvas{position:fixed;inset:0;z-index:0;pointer-events:none}
  .ui{
    position:relative;
    z-index:2;
    width:100%;
    max-width:980px;
    text-align:center;
    padding:28px;
    border-radius:16px;
    background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));
    box-shadow:0 10px 40px rgba(2,6,23,0.7), inset 0 1px 0 rgba(255,255,255,0.03);
    backdrop-filter:blur(6px) saturate(120%);
    transition:opacity 1s ease, transform 1s ease;
  }
  .ui.fade-out{
    opacity:0;
    transform:scale(0.96);
    pointer-events:none;
  }
  h1{margin:0 0 14px 0;font-weight:600;letter-spacing:1px;font-size:28px;color:#dff9ff;text-shadow:0 6px 22px rgba(51,209,255,0.06);}
  p.lead{margin:0 0 20px 0;color:#96f0ff;opacity:0.9;font-size:14px;}
  .countdown{display:flex;gap:14px;justify-content:center;flex-wrap:wrap;margin-bottom:22px;}
  .cell{min-width:86px;padding:16px 10px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));box-shadow:inset 0 1px 0 rgba(255,255,255,0.02);color:#e6fbff;}
  .num{font-size:34px;font-weight:700;letter-spacing:1px;color:#fff;text-shadow:0 6px 20px rgba(0,0,0,0.45);}
  .label{font-size:12px;color:rgba(255,255,255,0.65);margin-top:6px}
  .enter-btn{
    display:inline-block;
    margin-top:16px;
    padding:12px 24px;
    border-radius:999px;
    background:linear-gradient(90deg,var(--accent),var(--accent2));
    color:#07101a;
    font-weight:700;
    text-decoration:none;
    box-shadow:0 8px 30px rgba(51,209,255,0.12),0 2px 6px rgba(0,0,0,0.4);
    transform:translateY(0);
    transition:transform .22s ease,box-shadow .22s;
  }
  .enter-btn:hover{transform:translateY(-4px);box-shadow:0 18px 45px rgba(51,209,255,0.16)}
  .celebration-msg{
    position:absolute;
    left:50%;top:50%;
    transform:translate(-50%,-50%) scale(.9);
    z-index:3;
    pointer-events:none;
    color:#fff;
    text-align:center;
    opacity:0;
  }
  .celebration-msg.show{
    opacity:1;
    pointer-events:auto;
    animation:popIn .9s cubic-bezier(.2,.9,.3,1);
  }
  .celebration-msg h2{font-size:46px;margin:0 0 12px 0;letter-spacing:1px;text-shadow:0 10px 40px rgba(0,0,0,0.6),0 0 30px rgba(122,255,194,0.08);}
  .celebration-msg p{margin:0;color:rgba(255,255,255,0.9);font-size:18px}
  @keyframes popIn{0%{transform:translate(-50%,-50%) scale(.6);opacity:0}60%{transform:translate(-50%,-50%) scale(1.06);opacity:1}100%{transform:translate(-50%,-50%) scale(1)}}
  @media (max-width:560px){.num{font-size:28px}.cell{min-width:72px;padding:12px 8px}h1{font-size:20px}.celebration-msg h2{font-size:32px}}
</style>
</head>
<body>
<canvas id="fxCanvas"></canvas>

<div class="ui" id="ui">
  <h1>è·ç¦»è½©è½©ç”Ÿæ—¥è¿˜æœ‰</h1>
  <p class="lead">ç§‘æŠ€æ—¶é’Ÿæ­£åœ¨è¯»ç§’â€¦ å‡†å¤‡å¥½æƒŠå–œäº†å—ï¼Ÿ</p>

  <div class="countdown" id="countdown">
    <div class="cell"><div class="num" id="days">0</div><div class="label">å¤©</div></div>
    <div class="cell"><div class="num" id="hours">0</div><div class="label">å°æ—¶</div></div>
    <div class="cell"><div class="num" id="minutes">0</div><div class="label">åˆ†é’Ÿ</div></div>
    <div class="cell"><div class="num" id="seconds">0</div><div class="label">ç§’</div></div>
  </div>

  <!-- æ”¹ï¼šæŒ‰é’®é»˜è®¤æ˜¾ç¤º -->
  <a class="enter-btn" id="enterBtn" href="story.html">è¿›å…¥æˆ‘ä»¬çš„æ•…äº‹å†Œ</a>
</div>

<div class="celebration-msg" id="celebrationMsg" aria-hidden="true">
  <h2 id="mainText">ğŸ‚ è½©è½©ç”Ÿæ—¥å¿«ä¹</h2>
  <p id="subText">å†°å®ä¸€ç›´éƒ½åœ¨ä½ èº«è¾¹ ğŸ’™</p>
</div>

<script>
const TARGET = new Date('2025-11-14T00:00:00');
const CANVAS = document.getElementById('fxCanvas');
const ctx = CANVAS.getContext('2d', { alpha: true });
let W = CANVAS.width = innerWidth;
let H = CANVAS.height = innerHeight;

const daysEl = document.getElementById('days');
const hoursEl = document.getElementById('hours');
const minutesEl = document.getElementById('minutes');
const secondsEl = document.getElementById('seconds');
const enterBtn = document.getElementById('enterBtn');
const celebrationMsg = document.getElementById('celebrationMsg');
const ui = document.getElementById('ui');

addEventListener('resize', ()=>{ W = CANVAS.width = innerWidth; H = CANVAS.height = innerHeight; });

function pad(n){ return n.toString().padStart(2,'0'); }

let countdownTimer = null;
function updateCountdown(){
  const now = new Date();
  let diff = TARGET - now;
  if(diff <= 0){
    clearInterval(countdownTimer);
    showCelebration();
    return;
  }
  const days = Math.floor(diff / (1000*60*60*24));
  const hours = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
  const minutes = Math.floor((diff % (1000*60*60)) / (1000*60));
  const seconds = Math.floor((diff % (1000*60)) / 1000);
  daysEl.textContent = days;
  hoursEl.textContent = pad(hours);
  minutesEl.textContent = pad(minutes);
  secondsEl.textContent = pad(seconds);
}
updateCountdown();
countdownTimer = setInterval(updateCountdown, 1000);

if(new Date() >= TARGET){
  clearInterval(countdownTimer);
  setTimeout(showCelebration, 300);
}

let particles = [], hearts = [], celebrationActive = false, audioCtx = null;
class P {
  constructor(x,y,dx,dy,size,color,life){this.x=x;this.y=y;this.vx=dx;this.vy=dy;this.r=size;this.c=color;this.life=life||1;this.alpha=1;}
  update(dt){this.x+=this.vx*dt;this.y+=this.vy*dt;this.vy*=0.999;this.alpha-=0.008*dt;this.life-=0.008*dt;}
  draw(g){g.save();g.globalAlpha=Math.max(this.alpha,0);const g1=g.createLinearGradient(this.x-this.r,this.y-this.r,this.x+this.r,this.y+this.r);g1.addColorStop(0,this.c);g1.addColorStop(1,'rgba(255,255,255,0.07)');g.fillStyle=g1;g.beginPath();g.arc(this.x,this.y,this.r,0,Math.PI*2);g.fill();g.restore();}
}
function heartPoint(t,scale=1,cx=W/2,cy=H/2){const x=16*Math.pow(Math.sin(t),3);const y=13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t);return{x:cx+x*scale,y:cy-y*scale};}
function spawnNeonBurst(x,y,count,spread=1){for(let i=0;i<count;i++){const a=Math.random()*Math.PI*2,s=60+Math.random()*220;particles.push(new P(x,y,Math.cos(a)*s,Math.sin(a)*s,2+Math.random()*5,`hsl(${180+Math.random()*120},90%,60%)`,1));}}
function spawnRisingOrbs(count){for(let i=0;i<count;i++){particles.push(new P(Math.random()*W,H+Math.random()*80,(Math.random()-0.5)*20,-(60+Math.random()*140),6+Math.random()*12,`hsl(${180+Math.random()*120},80%,60%)`,1.5));}}
function spawnHeartParticles(total=160){const scale=Math.min(W,H)/60;for(let i=0;i<total;i++){const t=(i/total)*Math.PI*2;const p=heartPoint(t,scale,W/2,H/2-Math.min(H,400)/8);hearts.push(new P(p.x+(Math.random()-0.5)*6,p.y+(Math.random()-0.5)*6,(Math.random()-0.5)*20,(Math.random()-0.5)*20,3+Math.random()*3,`hsl(${320+Math.random()*40},90%,65%)`,2.2));}}
let last=performance.now();
function loop(now){const dt=Math.min(1.5,(now-last)/16.6667);last=now;ctx.clearRect(0,0,W,H);drawBackgroundStreams(now);for(let i=particles.length-1;i>=0;i--){const p=particles[i];p.update(dt);p.draw(ctx);if(p.life<=0||p.alpha<=0)particles.splice(i,1);}for(let i=hearts.length-1;i>=0;i--){const p=hearts[i];p.update(dt*0.6);p.draw(ctx);if(p.life<=0||p.alpha<=0)hearts.splice(i,1);}requestAnimationFrame(loop);}requestAnimationFrame(loop);
function drawBackgroundStreams(now){const c=Math.max(4,Math.floor(W/140));for(let i=0;i<c;i++){const x=(i+0.5)/c*W+Math.sin(now/1000+i)*60;const grad=ctx.createLinearGradient(x-100,0,x+100,H);grad.addColorStop(0,'rgba(80,120,160,0.02)');grad.addColorStop(0.5,'rgba(130,180,220,0.03)');grad.addColorStop(1,'rgba(80,120,160,0.02)');ctx.fillStyle=grad;ctx.fillRect(x-260,0,520,H);ctx.beginPath();ctx.rect(x-40,0,80,H);ctx.fillStyle='rgba(255,255,255,0.0025)';ctx.fill();}}
async function showCelebration(){
  if(celebrationActive)return;
  celebrationActive=true;
  // å€’è®¡æ—¶æ·¡å‡º
  ui.classList.add('fade-out');
  await flashScreen();
  spawnNeonBurst(W/2,H/2,220);
  startMelody();
  setTimeout(()=>spawnHeartParticles(240),600);
  const orbInterval=setInterval(()=>spawnRisingOrbs(12),400);
  const burstInterval=setInterval(()=>spawnNeonBurst(Math.random()*W,Math.random()*H*0.6,60+Math.floor(Math.random()*140)),900);
  setTimeout(()=>{celebrationMsg.classList.add('show');},900);
  setTimeout(()=>clearInterval(burstInterval),9000);
  setTimeout(()=>clearInterval(orbInterval),18000);
}
function flashScreen(){return new Promise(r=>{const o=document.createElement('div');o.style='position:fixed;inset:0;z-index:999;background:white;opacity:0;pointer-events:none;transition:opacity .12s ease';document.body.appendChild(o);requestAnimationFrame(()=>o.style.opacity='1');setTimeout(()=>o.style.opacity='0',120);setTimeout(()=>{o.remove();r();},300);});}
function startMelody(){try{if(!audioCtx){audioCtx=new (window.AudioContext||window.webkitAudioContext)();}const ctxA=audioCtx,master=ctxA.createGain();master.gain.value=0.08;master.connect(ctxA.destination);function playNote(t,f,d){const o=ctxA.createOscillator();o.type='triangle';o.frequency.value=f;const e=ctxA.createGain();e.gain.setValueAtTime(0.0001,t);e.gain.exponentialRampToValueAtTime(1.0,t+0.01);e.gain.exponentialRampToValueAtTime(0.0001,t+d);const filt=ctxA.createBiquadFilter();filt.type='lowpass';filt.frequency.value=Math.min(1200,800+Math.random()*600);o.connect(filt);filt.connect(e);e.connect(master);o.start(t);o.stop(t+d+0.02);}const now=ctxA.currentTime+0.05;base=440*Math.pow(2,(60-69)/12);seq=[0,2,4,0,7,6,0,2,4,0,9,7,0,12,10,7,5,4,11,11,9,7,9,7];let t=now;for(let i=0;i<seq.length;i++){const f=base*Math.pow(2,seq[i]/12);playNote(t,f,0.22);t+=0.26;}for(let i=0;i<3;i++){const o2=ctxA.createOscillator();const g2=ctxA.createGain();o2.type='sine';o2.frequency.value=55+i*8;g2.gain.setValueAtTime(0.02,ctxA.currentTime+0.2+i*0.3);g2.gain.exponentialRampToValueAtTime(0.0001,ctxA.currentTime+1.8+i*0.3);o2.connect(g2);g2.connect(master);o2.start(ctxA.currentTime+0.2+i*0.3);o2.stop(ctxA.currentTime+2.2+i*0.3);}}catch(e){console.warn('Audio error',e);}}
</script>
</body>
</html>
